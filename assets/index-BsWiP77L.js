import{U as I,r as f,d as D,j as e,D as Y,a as z,T as B,F as H,b as L,c as P,R as g,C as j,e as T,f as q,_ as y,l as G,g as J,u as K,h as Q,i as W,k as X,A as Z,m as $}from"./index-IeyI_kC-.js";const ee=({open:u,handleCancel:r,handleClose:a,handleOk:l,editData:t})=>{const{societyId:d}=I(),[i,m]=f.useState({societyId:"",announcementTitle:"",announcementDescription:"",announcementDate:null,announcementTime:null});f.useEffect(()=>{if(t){const c=D(t==null?void 0:t.announcementDate),x=D(t==null?void 0:t.announcementTime);m({societyId:d||"",announcementTitle:(t==null?void 0:t.announcementTitle)||"",announcementDescription:(t==null?void 0:t.announcementDescription)||"",announcementDate:c.isValid()?c:null,announcementTime:x.isValid()?x:null})}else m({societyId:d||"",announcementTitle:"",announcementDescription:"",announcementDate:null,announcementTime:null})},[t,d]);const o=(c,x)=>{m(A=>({...A,[c]:x}))},s=()=>{l(i)};return e.jsxs(Y,{title:t?"Edit Announcement":"Add Announcement",open:u,handleCancel:()=>{m({societyId:d||"",announcementTitle:"",announcementDescription:"",announcementDate:null,announcementTime:null}),r()},handleClose:a,handleOk:s,IsFooter:!0,handleContent:"Save",disabledButton:!i.announcementTitle||!i.announcementDescription||!i.announcementDate||!i.announcementTime,children:[e.jsx(z,{className:"mb-4",label:"Announcement Title",placeholder:"Enter Title",value:i.announcementTitle,onChange:c=>o("announcementTitle",c.target.value)}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{children:"Announcement Description"}),e.jsx(B,{placeholder:"Enter Description",autoSize:{minRows:2,maxRows:5},value:i.announcementDescription,onChange:c=>o("announcementDescription",c.target.value)})]}),e.jsxs(H,{justify:"space-between",align:"center",gap:"middle",className:"mb-4",children:[e.jsx(L,{block:!0,label:"Date",placeholder:"Select Date",value:i.announcementDate,onChange:c=>o("announcementDate",c)}),e.jsx(P,{use12Hours:!0,format:"h:mm a",value:i.announcementTime,onChange:c=>o("announcementTime",c)})]})]})},ne="_silver_vngd5_1",te="_dark_vngd5_9",p={silver:ne,dark:te},se=({open:u,handleCancel:r,handleClose:a,handleOk:l,title:t,Description:d,date:i,time:m,ModalTitle:o})=>e.jsx("div",{children:e.jsxs(Y,{title:o,open:u,handleOk:l,handleCancel:r,handleClose:a,IsFooter:!1,children:[e.jsxs(g,{className:"mb-4",children:[e.jsx(j,{span:24,children:e.jsx("h5",{className:p.silver,children:"Title"})}),e.jsx(j,{children:e.jsx("h5",{className:T(p.dark,"word-break"),children:t})})]}),e.jsxs(g,{className:"mb-4",children:[e.jsx(j,{span:24,children:e.jsx("h5",{className:p.silver,children:"Description"})}),e.jsx(j,{children:e.jsx("h5",{className:T(p.dark,"word-break"),children:d})})]}),e.jsxs(g,{className:"mb-4",children:[e.jsxs(j,{span:12,children:[e.jsx("h5",{className:p.silver,children:"Date"}),e.jsx("h5",{className:T(p.dark,"word-break"),children:i})]}),e.jsxs(j,{span:12,children:[e.jsx("h5",{className:p.silver,children:"Time"}),e.jsx("h5",{className:T(p.dark,"word-break"),children:m})]})]})]})}),ae=()=>({submitAnnouncement:async(r,a)=>{try{return await q(r),y.success("Announcement Added successfully."),a&&a(),{success:!0}}catch(l){return y.error("Failed to submit announcement."),{success:!1,error:l}}}}),le=()=>{const[u,r]=f.useState([]),{societyId:a}=I(),l=async()=>{if(a)try{const t=await G(a);r(t.data)}catch(t){console.error("Failed to fetch announcements:",t)}};return f.useEffect(()=>{l()},[a]),{announcements:u,refetchAnnouncements:l}},oe=()=>{const[u,r]=f.useState(!1),[a,l]=f.useState(null),[t,d]=f.useState(!1);return{announcementDelete:async m=>{try{r(!0);const o=await J(m);if(r(!1),o.message="success")return y.success("Announcement Is Delete Successfully"),{success:!0};throw new Error("Failed to delete announcement")}catch(o){return r(!1),console.error("Error deleting announcement:",o),{success:!1,error:o}}},loading:u,deleteAnnouncementData:a,setDeleteAnnouncementData:l,showDeleteModal:t,setShowDeleteModal:d}},ce=()=>({handleUpdateAnnouncement:async(r,a,l)=>{const t=await K(l,r);return y.success("Announcement updated successfully:",t.data),a(),{success:!0}}}),ie=()=>{var w,C,b,M,N,E;const{submitAnnouncement:u}=ae(),{handleUpdateAnnouncement:r}=ce(),{announcements:a,refetchAnnouncements:l}=le(),{announcementDelete:t,deleteAnnouncementData:d,setDeleteAnnouncementData:i,showDeleteModal:m,setShowDeleteModal:o}=oe(),[s,c]=f.useState({open:!1,data:[]}),[x,A]=f.useState(!1),[S,k]=f.useState(null),[_,V]=f.useState(null),F=(n,h)=>{n==="edit"?(V(h._id),k(h),A(!0)):n==="view"?c({open:!0,data:h}):n==="delete"&&(i(h),o(!0))},U=async n=>{let h;S?h=await r(n,l,_):h=await u(n,l),h.success&&(A(!1),k(null))},R=async()=>{d&&((await t(d._id)).success?(o(!1),i(null),await l()):console.log("Error deleting announcement"))};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Expanse Note || SMS",description:"Manage your financial notes and announcements effectively with Expanse Note.",keywords:"financial, notes, society, announcements, updates",ogTitle:"Expanse Note || SMC",ogDescription:"Stay organized and keep track of your society's financial notes with Expanse Note.",ogUrl:"http://localhost:5173/admin/financial/note",twitterCard:"summary_large_image",twitterTitle:"Expanse Note || SMC",twitterDescription:"Catch up with the latest financial updates and notes from your society."}),e.jsxs(W,{title:"Announcement",headerContent:e.jsx(X,{variant:"primary",onClick:()=>A(!0),children:"Create Announcement"}),className:"announcement-card-grid",children:[a==null?void 0:a.map(n=>{const h=D(n==null?void 0:n.announcementDate),v=D(n==null?void 0:n.announcementTime);return e.jsx(Z,{_id:n==null?void 0:n._id,title:n==null?void 0:n.announcementTitle,description:n==null?void 0:n.announcementDescription,date:h.isValid()?h.format("YYYY-MM-DD"):"Invalid Date",time:v.isValid()?v.format("YYYY-MM-DD"):"Invalid Time",items:[{label:"Edit",key:"edit"},{label:"View",key:"view"},{label:"Delete",key:"delete"}],onAction:O=>F(O,n)},n==null?void 0:n._id)}),x&&e.jsx(ee,{open:x,handleCancel:()=>A(!1),handleClose:()=>A(!1),handleOk:n=>U(n),editData:S}),s.open&&e.jsx(se,{open:s.open,announcementData:s.data,handleCancel:()=>c({open:!1,data:null}),handleClose:()=>c({open:!1,data:null}),ModalTitle:"View Announcement",title:(w=s==null?void 0:s.data)==null?void 0:w.announcementTitle,Description:(C=s==null?void 0:s.data)==null?void 0:C.announcementDescription,date:D((b=s==null?void 0:s.data)==null?void 0:b.announcementDate).isValid()?D((M=s==null?void 0:s.data)==null?void 0:M.announcementDate).format("YYYY-MM-DD"):"Invalid Date",time:D((N=s==null?void 0:s.data)==null?void 0:N.announcementTime).isValid()?D((E=s==null?void 0:s.data)==null?void 0:E.announcementTime).format("YYYY-MM-DD"):"Invalid Time"}),m&&e.jsx($,{Title:"Delete Announcement?",isModalOpen:m,handleClose:()=>o(!1),handleOk:R,onCancel:()=>o(!1),children:"Are you sure you want to delete this announcement?"})]})]})};export{ie as default};
