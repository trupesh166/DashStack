import{j as e,D as L,a as A,T as F,R as b,C as D,U as T,r as n,_ as f,Q as z,W as O,X as R,Y as V,i as B,k as M,z as U,m as $,S as q,I}from"./index-Cx4XMxsI.js";const Q="_addSecurityProtocolModal_v71eh_1",W="_dark_v71eh_9",E={addSecurityProtocolModal:Q,dark:W},X=({open:l,handleCancel:r,handleClose:s,handleOk:i,protocol:t,isEdit:o,handleChange:a,isSubmitting:d})=>e.jsx("div",{className:E.addSecurityProtocolModal,children:e.jsxs(L,{title:o?"Edit Security Protocol":"Create Security Protocol",open:l,closeIcon:!0,handleCancel:r,handleClose:s,handleOk:i,IsFooter:!0,handleContent:"Save",disabledButton:d,children:[e.jsx(A,{className:"mb-4",label:"Title",placeholder:"Enter Title",value:t==null?void 0:t.title,onChange:h=>a("title",h.target.value)}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:E.dark,children:"Description"}),e.jsx(F,{placeholder:"Enter Description",autoSize:{minRows:1.5,maxRows:5},value:t==null?void 0:t.description,onChange:h=>a("description",h.target.value)})]})]})}),Y="_viewSecurityProtocolModal_16eyk_1",G="_silver_16eyk_9",H="_dark_16eyk_17",m={viewSecurityProtocolModal:Y,silver:G,dark:H},J=({open:l,handleCancel:r,handleClose:s,handleOk:i,protocol:t})=>{console.log(t);const o=a=>{const d=new Date(a);return{date:d.toLocaleDateString(),time:d.toLocaleTimeString()}};return e.jsx("div",{className:m.viewSecurityProtocolModal,children:e.jsxs(L,{title:"View Security Protocol",open:l,closeIcon:!0,handleOk:i,handleCancel:r,handleClose:s,IsFooter:!1,children:[e.jsxs(b,{className:"mb-4",children:[e.jsx(D,{span:24,children:e.jsx("h5",{className:m.silver,children:"Title"})}),e.jsx(D,{children:e.jsx("h5",{className:m.dark,children:t==null?void 0:t.title})})]}),e.jsxs(b,{className:"mb-4",children:[e.jsx(D,{span:24,children:e.jsx("h5",{className:m.silver,children:"Description"})}),e.jsx(D,{span:24,children:e.jsx("h5",{className:m.dark,children:t==null?void 0:t.discription})})]}),e.jsxs(b,{className:"mb-4",children:[e.jsxs(D,{span:12,children:[e.jsx("h5",{className:m.silver,children:"Date"}),e.jsx("h5",{className:m.dark,children:o(t==null?void 0:t.createdAt).date})]}),e.jsxs(D,{span:12,children:[e.jsx("h5",{className:m.silver,children:"Time"}),e.jsx("h5",{className:m.dark,children:o(t==null?void 0:t.createdAt).time})]})]})]})})},K=l=>{const{societyId:r}=T(),[s,i]=n.useState({title:"",description:""}),[t,o]=n.useState(!1),[a,d]=n.useState(!1),[h,y]=n.useState(!1),[w,g]=n.useState(null),v=()=>{p(),d(!0)},N=u=>{g(u._id),i({title:u.title,description:u.discription}),y(!0),d(!0)},k=()=>{p(),d(!1)},p=()=>{i({title:"",description:""}),g(null),y(!1)};return{formData:s,handleChange:(u,S)=>{i(x=>({...x,[u]:S}))},isSubmitting:t,isModalOpen:a,openCreateModal:v,openEditModal:N,closeModal:k,handleSubmit:async()=>{const{title:u,description:S}=s;if(!u||!S){f.error("Please fill in all required fields.");return}o(!0);const x={societyId:r,title:s.title,discription:s.description};try{w?(await z(w,x),f.success("Security Protocol updated successfully.")):(await O(x),f.success("Security Protocol created successfully.")),l&&l(),k()}catch(C){console.error("Error submitting security protocol:",C),f.error("Failed to submit security protocol.")}finally{o(!1)}},isEdit:h}},Z=()=>{const{societyId:l}=T(),[r,s]=n.useState([]),[i,t]=n.useState(!1),o=async()=>{if(l)try{t(!0);const a=await R(l);s((a==null?void 0:a.data)||[])}catch(a){console.error("Failed to fetch Security Protocols:",a)}finally{t(!1)}};return n.useEffect(()=>{o()},[l]),{dataListProtocols:r,fetchListProtocols:o,isLoading:i}},ee=l=>{const[r,s]=n.useState(!1),[i,t]=n.useState(null),[o,a]=n.useState(!1);return{protocolDelete:async h=>{try{s(!0);const y=await V(h);if(s(!1),y.message==="Success")f.success("Security Protocol deleted successfully."),l();else throw new Error("Failed to delete security protocol.")}catch(y){s(!1),console.error("Error deleting security protocol:",y),f.error("Failed to delete security protocol.")}},loading:r,deleteProtocolData:i,setDeleteProtocolData:t,showDeleteModal:o,setShowDeleteModal:a}},se=()=>{const{dataListProtocols:l,fetchListProtocols:r,isLoading:s}=Z(),{formData:i,handleChange:t,isSubmitting:o,isModalOpen:a,openCreateModal:d,openEditModal:h,closeModal:y,handleSubmit:w,isEdit:g}=K(r),{protocolDelete:v,loading:N,deleteProtocolData:k,setDeleteProtocolData:p,showDeleteModal:_,setShowDeleteModal:j}=ee(r),[u,S]=n.useState(null),x=P=>{const c=new Date(P);return{date:c.toLocaleDateString(),time:c.toLocaleTimeString()}},C=[{title:"Title",dataIndex:"title",key:"title"},{title:"Description",dataIndex:"discription",key:"description"},{title:"Date",dataIndex:"createdAt",key:"date",render:P=>{const{date:c}=x(P);return c}},{title:"Time",dataIndex:"createdAt",key:"time",render:P=>{const{time:c}=x(P);return c}},{title:"Action",key:"action",render:(P,c)=>e.jsxs(q,{size:"middle",children:[e.jsx(M,{type:"primary",size:"small",icon:I.Edit,className:"edit-btn",onClick:()=>h(c)}),e.jsx(M,{type:"primary",size:"small",icon:I.EyeShow,className:"view-btn",onClick:()=>S(c)}),e.jsx(M,{type:"primary",size:"small",icon:I.Trash,className:"delete-btn",onClick:()=>{p(c),j(!0)}})]})}];return e.jsxs("div",{children:[e.jsx(B,{title:"Security Protocols",headerContent:e.jsx(M,{variant:"primary",onClick:d,children:"Create Protocol"}),children:e.jsx(U,{dataSource:l,tableColumn:C,pagination:!1,loading:s,rowClassName:(P,c)=>c%2===0?"table-row-light":"table-row-dark"})}),e.jsx(X,{open:a,handleCancel:y,handleClose:y,handleOk:w,protocol:i,isEdit:g,handleChange:t,isSubmitting:o}),e.jsx(J,{open:!!u,protocol:u,handleCancel:()=>S(null),handleClose:()=>S(null)}),e.jsx($,{title:"Delete Protocol?",isModalOpen:_,handleClose:()=>j(!1),handleOk:()=>{v(k._id),j(!1)},onCancel:()=>j(!1),children:"Are you sure you want to delete this Protocol?"})]})};export{se as default};
